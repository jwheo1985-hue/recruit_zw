<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì±„ìš© ê´€ë¦¬ ì—ì´ì „íŠ¸</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');

:root {
  --bg:      #0b0e16;
  --s1:      #111520;
  --s2:      #181d2c;
  --s3:      #1e2438;
  --border:  #252c42;
  --border2: #2e3650;
  --blue:    #4f9fff;
  --violet:  #8b7cf8;
  --green:   #34d399;
  --yellow:  #fbbf24;
  --red:     #f87171;
  --muted:   #8b95b0;
  --text:    #e2e8f8;
  --r:       12px;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Noto Sans KR',sans-serif;background:var(--bg);color:var(--text);display:flex;height:100vh;overflow:hidden;font-size:14px;}

/* â”€â”€ SIDEBAR â”€â”€ */
#sidebar{width:230px;min-width:230px;background:var(--s1);border-right:1px solid var(--border);display:flex;flex-direction:column;}
.logo{padding:22px 20px 18px;border-bottom:1px solid var(--border);}
.logo-t{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--blue);letter-spacing:2px;margin-bottom:3px;}
.logo-s{font-size:11px;color:var(--muted);}
.nav-sec{padding:18px 20px 6px;font-size:10px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;}
.nav-item{display:flex;align-items:center;gap:10px;padding:11px 14px;margin:2px 8px;border-radius:9px;cursor:pointer;color:var(--muted);font-size:13px;font-weight:500;transition:background .15s,color .15s;user-select:none;}
.nav-item:hover{background:var(--s2);color:var(--text);}
.nav-item.active{background:rgba(79,159,255,.13);color:var(--blue);}
.nav-ico{font-size:15px;width:22px;text-align:center;flex-shrink:0;}
.nav-cnt{margin-left:auto;font-family:'JetBrains Mono',monospace;font-size:10px;background:var(--s3);padding:2px 8px;border-radius:20px;color:var(--muted);min-width:24px;text-align:center;}
.nav-item.active .nav-cnt{background:rgba(79,159,255,.2);color:var(--blue);}
.sb-foot{margin-top:auto;padding:14px 18px;border-top:1px solid var(--border);font-size:11px;color:var(--muted);}

/* â”€â”€ MAIN â”€â”€ */
#main{flex:1;display:flex;flex-direction:column;overflow:hidden;}
#topbar{height:58px;background:var(--s1);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 26px;gap:12px;flex-shrink:0;}
#page-title{font-size:15px;font-weight:700;flex:1;}
#content{flex:1;overflow-y:auto;padding:26px;scrollbar-width:thin;scrollbar-color:var(--border2) transparent;}
#content::-webkit-scrollbar{width:5px;}
#content::-webkit-scrollbar-thumb{background:var(--border2);border-radius:10px;}

.page{display:none;animation:fi .2s ease;}
.page.active{display:block;}
@keyframes fi{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

/* â”€â”€ DASHBOARD â”€â”€ */
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:22px;}
.sc{background:var(--s1);border:1px solid var(--border);border-radius:var(--r);padding:18px 20px;position:relative;overflow:hidden;}
.sc::after{content:'';position:absolute;top:0;left:0;right:0;height:2px;}
.sc.b::after{background:var(--blue)}.sc.v::after{background:var(--violet)}.sc.g::after{background:var(--green)}.sc.r::after{background:var(--red)}
.sc-lbl{font-size:11px;color:var(--muted);margin-bottom:10px;}
.sc-val{font-family:'JetBrains Mono',monospace;font-size:30px;font-weight:500;}
.sc.b .sc-val{color:var(--blue)}.sc.v .sc-val{color:var(--violet)}.sc.g .sc-val{color:var(--green)}.sc.r .sc-val{color:var(--red)}
.sc-sub{font-size:11px;color:var(--muted);margin-top:6px;}

.pc{background:var(--s1);border:1px solid var(--border);border-radius:var(--r);padding:20px 22px;margin-bottom:20px;}
.pc h3{font-size:13px;color:var(--muted);margin-bottom:18px;}
.ps{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;}
.psi{background:var(--s2);border-radius:9px;padding:14px;text-align:center;}
.psi-l{font-size:11px;color:var(--muted);margin-bottom:8px;}
.psi-n{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:500;}

.card{background:var(--s1);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;}
.card-hd{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;border-bottom:1px solid var(--border);}
.card-ttl{font-size:13px;font-weight:600;}

table{width:100%;border-collapse:collapse;}
th{background:var(--s2);font-size:11px;color:var(--muted);padding:10px 16px;text-align:left;font-weight:500;letter-spacing:.5px;}
td{padding:11px 16px;font-size:13px;border-bottom:1px solid var(--border);vertical-align:middle;}
tr:last-child td{border-bottom:none;}
tbody tr:hover td{background:rgba(255,255,255,.02);cursor:pointer;}

/* â”€â”€ BADGES â”€â”€ */
.badge{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;white-space:nowrap;}
.b-ì„œë¥˜ê²€í† {background:rgba(79,159,255,.15);color:var(--blue);}
.b-1ì°¨ë©´ì ‘{background:rgba(139,124,248,.15);color:var(--violet);}
.b-2ì°¨ë©´ì ‘{background:rgba(251,191,36,.15);color:var(--yellow);}
.b-ìµœì¢…í•©ê²©{background:rgba(52,211,153,.15);color:var(--green);}
.b-ë¶ˆí•©ê²©{background:rgba(248,113,113,.15);color:var(--red);}
.b-ë³´ë¥˜{background:rgba(139,149,176,.15);color:var(--muted);}

/* â”€â”€ FILTER BAR â”€â”€ */
.fbar{display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap;align-items:center;}
.sw{flex:1;min-width:200px;position:relative;}
.sw .si{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--muted);font-size:14px;pointer-events:none;}
.sw input{padding-left:36px !important;width:100%;}

input,select,textarea{background:var(--s1);border:1px solid var(--border);border-radius:8px;padding:9px 12px;color:var(--text);font-size:13px;font-family:inherit;outline:none;transition:border-color .15s;}
input:focus,select:focus,textarea:focus{border-color:var(--blue);}
select option{background:var(--s2);}
textarea{resize:vertical;}

.chips{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:16px;}
.chip{padding:5px 13px;border-radius:20px;font-size:12px;cursor:pointer;border:1px solid var(--border);color:var(--muted);background:var(--s1);transition:all .15s;font-weight:500;}
.chip:hover{border-color:var(--blue);color:var(--text);}
.chip.active{background:rgba(79,159,255,.15);border-color:var(--blue);color:var(--blue);}

/* â”€â”€ BUTTONS â”€â”€ */
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 18px;border-radius:8px;border:none;cursor:pointer;font-size:13px;font-family:inherit;font-weight:600;transition:all .15s;white-space:nowrap;}
.btn:disabled{opacity:.5;cursor:not-allowed;}
.bp{background:var(--blue);color:#fff;}.bp:hover:not(:disabled){background:#3a8fee;}
.bg{background:var(--s2);color:var(--text);border:1px solid var(--border);}.bg:hover:not(:disabled){border-color:var(--blue);color:var(--blue);}
.bd{background:rgba(248,113,113,.12);color:var(--red);border:1px solid rgba(248,113,113,.25);}.bd:hover:not(:disabled){background:rgba(248,113,113,.22);}
.bsm{padding:5px 12px;font-size:12px;border-radius:6px;}
.bai{background:linear-gradient(135deg,#4f9fff22,#8b7cf822);color:var(--violet);border:1px solid rgba(139,124,248,.3);}.bai:hover:not(:disabled){background:linear-gradient(135deg,#4f9fff33,#8b7cf833);}

/* â”€â”€ UPLOAD â”€â”€ */
.upz{border:2px dashed var(--border2);border-radius:var(--r);padding:52px 32px;text-align:center;cursor:pointer;transition:all .2s;margin-bottom:20px;background:var(--s1);}
.upz:hover,.upz.drag{border-color:var(--blue);background:rgba(79,159,255,.04);}
.up-ico{font-size:46px;margin-bottom:14px;}
.upz h3{font-size:15px;font-weight:600;margin-bottom:8px;}
.upz p{font-size:12px;color:var(--muted);}
.psec{background:var(--s1);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;margin-bottom:14px;}
.pgrd{display:grid;grid-template-columns:1fr 1fr;gap:14px;padding:20px;}
.pf-l{font-size:11px;color:var(--muted);margin-bottom:4px;}
.pf-v{font-size:13px;font-weight:500;}
.pfull{grid-column:1/-1;}
.aibox{background:var(--s2);border:1px solid rgba(139,124,248,.25);border-radius:var(--r);padding:20px;margin-top:14px;}
.aibox-h{font-size:12px;color:var(--violet);font-family:'JetBrains Mono',monospace;letter-spacing:1px;margin-bottom:14px;}
.aibox-c{font-size:13px;line-height:1.85;white-space:pre-wrap;}

/* â”€â”€ PIPELINE â”€â”€ */
.board{display:grid;grid-template-columns:repeat(5,1fr);gap:14px;align-items:start;}
.bcol{background:var(--s1);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;}
.bcol-h{padding:12px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:7px;font-size:12px;font-weight:600;}
.bcol-cnt{margin-left:auto;font-family:'JetBrains Mono',monospace;font-size:11px;background:var(--s2);padding:2px 7px;border-radius:20px;color:var(--muted);}
.bcol-b{padding:10px;display:flex;flex-direction:column;gap:8px;min-height:60px;}
.bcard{background:var(--s2);border-radius:8px;padding:12px;cursor:pointer;border:1px solid var(--border);transition:border-color .15s,transform .1s;}
.bcard:hover{border-color:var(--border2);transform:translateY(-1px);}
.bcard-n{font-size:13px;font-weight:600;margin-bottom:3px;}
.bcard-j{font-size:11px;color:var(--muted);}
.bcard-s{font-size:10px;color:var(--muted);margin-top:5px;opacity:.7;}

/* â”€â”€ MODAL â”€â”€ */
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.65);z-index:999;align-items:center;justify-content:center;backdrop-filter:blur(2px);}
.overlay.open{display:flex;}
.modal{background:var(--s1);border:1px solid var(--border2);border-radius:14px;width:580px;max-width:96vw;max-height:88vh;overflow-y:auto;padding:26px;scrollbar-width:thin;}
.mlg{width:680px;}
.mhd{display:flex;align-items:center;justify-content:space-between;margin-bottom:22px;}
.mhd h2{font-size:15px;font-weight:700;}
.mclose{background:none;border:none;color:var(--muted);font-size:22px;cursor:pointer;line-height:1;padding:2px 6px;border-radius:5px;}
.mclose:hover{color:var(--text);background:var(--s2);}
.mft{display:flex;gap:10px;justify-content:flex-end;margin-top:22px;padding-top:18px;border-top:1px solid var(--border);}
.frow{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
.fg{margin-bottom:14px;}
.fg label{display:block;font-size:11px;color:var(--muted);margin-bottom:5px;}
.fg input,.fg select,.fg textarea{width:100%;}

/* â”€â”€ DETAIL â”€â”€ */
.dsec{margin-bottom:18px;}
.dsec-t{font-size:11px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid var(--border);}
.dgrd{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.di-l{font-size:11px;color:var(--muted);margin-bottom:3px;}
.di-v{font-size:13px;font-weight:500;}
.dtxt{background:var(--s2);border-radius:8px;padding:14px;font-size:13px;line-height:1.75;white-space:pre-wrap;max-height:180px;overflow-y:auto;}
.scbar{display:flex;gap:8px;align-items:center;margin-top:12px;}
.scbar select{flex:1;}
.hist{display:flex;flex-direction:column;}
.hi{display:flex;gap:12px;padding:9px 0;border-bottom:1px solid var(--border);font-size:12px;align-items:flex-start;}
.hi:last-child{border-bottom:none;}
.hidot{width:7px;height:7px;border-radius:50%;background:var(--blue);margin-top:4px;flex-shrink:0;}
.hidate{color:var(--muted);font-family:'JetBrains Mono',monospace;font-size:11px;min-width:82px;}

/* â”€â”€ SETTINGS â”€â”€ */
.sset{background:var(--s1);border:1px solid var(--border);border-radius:var(--r);padding:22px;margin-bottom:16px;max-width:640px;}
.sset h3{font-size:13px;font-weight:600;margin-bottom:4px;}
.sset p{font-size:12px;color:var(--muted);margin-bottom:16px;}

/* â”€â”€ UTILS â”€â”€ */
.flex{display:flex;}.aic{align-items:center;}.jsb{justify-content:space-between;}.g2{gap:8px;}.g3{gap:12px;}
.mt3{margin-top:12px;}.mt4{margin-top:16px;}.mb3{margin-bottom:12px;}.mb4{margin-bottom:16px;}
.tm{color:var(--muted);}.tsm{font-size:12px;}
.empty{text-align:center;padding:48px 20px;color:var(--muted);}
.empty-i{font-size:36px;margin-bottom:10px;}
.empty-t{font-size:13px;}

/* â”€â”€ TOAST â”€â”€ */
#toast{position:fixed;bottom:22px;right:22px;background:var(--s2);border:1px solid var(--border2);border-radius:10px;padding:12px 18px;font-size:13px;z-index:9999;pointer-events:none;transform:translateY(80px);opacity:0;transition:all .28s cubic-bezier(.34,1.56,.64,1);}
#toast.show{transform:translateY(0);opacity:1;}
#toast.ok{border-color:var(--green);}
#toast.err{border-color:var(--red);}
.spin{display:inline-block;width:14px;height:14px;border:2px solid rgba(139,124,248,.3);border-top-color:var(--violet);border-radius:50%;animation:sp .65s linear infinite;}
@keyframes sp{to{transform:rotate(360deg)}}
</style>
</head>
<body>

<!-- SIDEBAR -->
<nav id="sidebar">
  <div class="logo">
    <div class="logo-t">RECRUIT AI</div>
    <div class="logo-s">ì±„ìš© ê´€ë¦¬ ì—ì´ì „íŠ¸</div>
  </div>
  <div class="nav-sec">ë©”ë‰´</div>
  <div class="nav-item active" data-pg="dashboard"><span class="nav-ico">ğŸ“Š</span>ëŒ€ì‹œë³´ë“œ</div>
  <div class="nav-item" data-pg="applicants"><span class="nav-ico">ğŸ‘¥</span>ì§€ì›ì ëª©ë¡<span class="nav-cnt" id="nc">0</span></div>
  <div class="nav-item" data-pg="upload"><span class="nav-ico">ğŸ“„</span>ì´ë ¥ì„œ ì—…ë¡œë“œ</div>
  <div class="nav-item" data-pg="pipeline"><span class="nav-ico">ğŸ”„</span>ì±„ìš© íŒŒì´í”„ë¼ì¸</div>
  <div class="nav-sec">ì„¤ì •</div>
  <div class="nav-item" data-pg="settings"><span class="nav-ico">âš™ï¸</span>ì„¤ì •</div>
  <div class="sb-foot">ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì €ì— ì €ì¥ë©ë‹ˆë‹¤</div>
</nav>

<!-- MAIN -->
<div id="main">
  <div id="topbar">
    <div id="page-title">ëŒ€ì‹œë³´ë“œ</div>
    <button class="btn bg bsm" onclick="exportJSON()">ğŸ“¤ ë‚´ë³´ë‚´ê¸°</button>
    <button class="btn bp" onclick="openAddModal()">+ ì§€ì›ì ì¶”ê°€</button>
  </div>
  <div id="content">

    <!-- DASHBOARD -->
    <div class="page active" id="page-dashboard">
      <div class="stats-row">
        <div class="sc b"><div class="sc-lbl">ì „ì²´ ì§€ì›ì</div><div class="sc-val" id="s-total">0</div><div class="sc-sub">ëˆ„ì  ë“±ë¡</div></div>
        <div class="sc v"><div class="sc-lbl">ì§„í–‰ì¤‘</div><div class="sc-val" id="s-active">0</div><div class="sc-sub">ê²€í† Â·ë©´ì ‘</div></div>
        <div class="sc g"><div class="sc-lbl">ìµœì¢…í•©ê²©</div><div class="sc-val" id="s-pass">0</div><div class="sc-sub">í•©ê²©ë¥  <span id="s-rate">0</span>%</div></div>
        <div class="sc r"><div class="sc-lbl">ë¶ˆí•©ê²©</div><div class="sc-val" id="s-fail">0</div><div class="sc-sub">íƒˆë½</div></div>
      </div>
      <div class="pc">
        <h3>ë‹¨ê³„ë³„ í˜„í™©</h3>
        <div class="ps">
          <div class="psi"><div class="psi-l">ğŸ“‹ ì„œë¥˜ê²€í† </div><div class="psi-n" style="color:var(--blue)" id="ps0">0</div></div>
          <div class="psi"><div class="psi-l">ğŸ¤ 1ì°¨ë©´ì ‘</div><div class="psi-n" style="color:var(--violet)" id="ps1">0</div></div>
          <div class="psi"><div class="psi-l">ğŸ¯ 2ì°¨ë©´ì ‘</div><div class="psi-n" style="color:var(--yellow)" id="ps2">0</div></div>
          <div class="psi"><div class="psi-l">âœ… ìµœì¢…í•©ê²©</div><div class="psi-n" style="color:var(--green)" id="ps3">0</div></div>
          <div class="psi"><div class="psi-l">âŒ ë¶ˆí•©ê²©</div><div class="psi-n" style="color:var(--red)" id="ps4">0</div></div>
        </div>
      </div>
      <div class="card">
        <div class="card-hd"><span class="card-ttl">ìµœê·¼ ì§€ì›ì</span><button class="btn bg bsm" onclick="goPage('applicants')">ì „ì²´ ë³´ê¸° â†’</button></div>
        <table><thead><tr><th>ì´ë¦„</th><th>ì§€ì› ì§ë¬´</th><th>ì¶œì²˜</th><th>ë‹¨ê³„</th><th>ë“±ë¡ì¼</th></tr></thead><tbody id="dash-tb"></tbody></table>
      </div>
    </div>

    <!-- APPLICANTS -->
    <div class="page" id="page-applicants">
      <div class="fbar">
        <div class="sw"><span class="si">ğŸ”</span><input type="text" id="qs" placeholder="ì´ë¦„, ì§ë¬´, ë©”ëª¨ ê²€ìƒ‰..."></div>
        <select id="qsrc"><option value="">ì „ì²´ ì¶œì²˜</option><option>ì‚¬ëŒì¸</option><option>ì¡ì½”ë¦¬ì•„</option><option>PDFì´ë ¥ì„œ</option><option>ì§ì ‘ì…ë ¥</option></select>
        <select id="qjob"><option value="">ì „ì²´ ì§ë¬´</option></select>
      </div>
      <div class="chips" id="chips">
        <div class="chip active" data-st="">ì „ì²´</div>
        <div class="chip" data-st="ì„œë¥˜ê²€í† ">ğŸ“‹ ì„œë¥˜ê²€í† </div>
        <div class="chip" data-st="1ì°¨ë©´ì ‘">ğŸ¤ 1ì°¨ë©´ì ‘</div>
        <div class="chip" data-st="2ì°¨ë©´ì ‘">ğŸ¯ 2ì°¨ë©´ì ‘</div>
        <div class="chip" data-st="ìµœì¢…í•©ê²©">âœ… ìµœì¢…í•©ê²©</div>
        <div class="chip" data-st="ë¶ˆí•©ê²©">âŒ ë¶ˆí•©ê²©</div>
        <div class="chip" data-st="ë³´ë¥˜">â¸ ë³´ë¥˜</div>
      </div>
      <div class="card">
        <div class="card-hd"><span class="card-ttl">ì§€ì›ì ëª©ë¡</span><span class="tm tsm" id="lcnt"></span></div>
        <table><thead><tr><th>ì´ë¦„</th><th>ì—°ë½ì²˜</th><th>ì§€ì› ì§ë¬´</th><th>ì¶œì²˜</th><th>ë‹¨ê³„</th><th>ë“±ë¡ì¼</th><th style="width:120px">ì•¡ì…˜</th></tr></thead><tbody id="list-tb"></tbody></table>
      </div>
    </div>

    <!-- UPLOAD -->
    <div class="page" id="page-upload">
      <div class="upz" id="upz">
        <div class="up-ico">ğŸ“„</div>
        <h3>ì´ë ¥ì„œë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•´ì„œ ì—…ë¡œë“œ</h3>
        <p style="margin-top:6px">ì‚¬ëŒì¸ Â· ì¡ì½”ë¦¬ì•„ HTML ë˜ëŠ” PDF, TXT íŒŒì¼</p>
        <p style="margin-top:4px">PDFëŠ” í…ìŠ¤íŠ¸ ì¶”ì¶œ í›„ AI ë¶„ì„ ê°€ëŠ¥</p>
        <input type="file" id="fi" accept=".pdf,.html,.htm,.txt" style="display:none">
      </div>
      <div id="upres" style="display:none">
        <div class="psec">
          <div class="card-hd"><span class="card-ttl">íŒŒì‹±ëœ ì •ë³´</span><span class="tm tsm" id="upfn"></span></div>
          <div class="pgrd" id="pgrd"></div>
        </div>
        <div id="airesbox" style="display:none">
          <div class="aibox"><div class="aibox-h">âœ¦ AI ë¶„ì„ ê²°ê³¼</div><div class="aibox-c" id="aitext"></div></div>
        </div>
        <div class="flex g2 mt4" style="flex-wrap:wrap">
          <button class="btn bp" onclick="saveFromUpload()">ğŸ’¾ ì§€ì›ìë¡œ ì €ì¥</button>
          <button class="btn bai" id="aibtn" onclick="runAI()">ğŸ¤– AI ë¶„ì„ Â· ìš”ì•½</button>
          <button class="btn bg" onclick="resetUpload()">ğŸ”„ ì´ˆê¸°í™”</button>
        </div>
      </div>
    </div>

    <!-- PIPELINE -->
    <div class="page" id="page-pipeline">
      <div class="board" id="board"></div>
    </div>

    <!-- SETTINGS -->
    <div class="page" id="page-settings">
      <div class="sset">
        <h3>ğŸ¤– Gemini API ì„¤ì •</h3>
        <p>ì´ë ¥ì„œ AI ë¶„ì„ì— ì‚¬ìš©ë©ë‹ˆë‹¤. Google AI Studioì—ì„œ ë¬´ë£Œ ë°œê¸‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
        <div class="fg"><label>API Key</label><input type="password" id="cak" placeholder="AIza..."></div>
        <div class="fg"><label>ëª¨ë¸</label>
          <select id="cmod">
            <option value="gemini-1.5-flash">gemini-1.5-flash (ë¹ ë¦„ Â· ë¬´ë£Œ í‹°ì–´)</option>
            <option value="gemini-2.0-flash">gemini-2.0-flash (ìµœì‹  Â· ë¹ ë¦„)</option>
            <option value="gemini-1.5-pro">gemini-1.5-pro (ì •í™• Â· ìœ ë£Œ)</option>
          </select>
        </div>
        <button class="btn bp" onclick="saveCfg()">ì €ì¥</button>
      </div>
      <div class="sset">
        <h3>ğŸ’¾ ë°ì´í„° ê´€ë¦¬</h3>
        <p>ì „ì²´ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë°±ì—…í•˜ê±°ë‚˜ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        <div class="flex g2" style="flex-wrap:wrap">
          <button class="btn bg" onclick="exportJSON()">ğŸ“¤ JSON ë‚´ë³´ë‚´ê¸°</button>
          <button class="btn bg" onclick="document.getElementById('impf').click()">ğŸ“¥ JSON ê°€ì ¸ì˜¤ê¸°</button>
          <button class="btn bd" onclick="clearAll()">ğŸ—‘ï¸ ì „ì²´ ì´ˆê¸°í™”</button>
        </div>
        <input type="file" id="impf" accept=".json" style="display:none" onchange="importJSON(event)">
      </div>
      <div class="sset">
        <h3>ğŸ“‹ ì±„ìš© ë‹¨ê³„</h3>
        <p>í˜„ì¬ ì„¤ì •ëœ ì±„ìš© ë‹¨ê³„ ìˆœì„œì…ë‹ˆë‹¤.</p>
        <div class="flex g2" style="flex-wrap:wrap;align-items:center">
          <span class="badge b-ì„œë¥˜ê²€í† ">ğŸ“‹ ì„œë¥˜ê²€í† </span><span class="tm">â†’</span>
          <span class="badge b-1ì°¨ë©´ì ‘">ğŸ¤ 1ì°¨ë©´ì ‘</span><span class="tm">â†’</span>
          <span class="badge b-2ì°¨ë©´ì ‘">ğŸ¯ 2ì°¨ë©´ì ‘</span><span class="tm">â†’</span>
          <span class="badge b-ìµœì¢…í•©ê²©">âœ… ìµœì¢…í•©ê²©</span><span class="tm">/</span>
          <span class="badge b-ë¶ˆí•©ê²©">âŒ ë¶ˆí•©ê²©</span>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- MODAL ADD/EDIT -->
<div class="overlay" id="modal-add">
  <div class="modal">
    <div class="mhd"><h2 id="add-ttl">ì§€ì›ì ì¶”ê°€</h2><button class="mclose" onclick="closeModal('modal-add')">Ã—</button></div>
    <input type="hidden" id="eid">
    <div class="frow">
      <div class="fg"><label>ì´ë¦„ *</label><input type="text" id="fn" placeholder="í™ê¸¸ë™"></div>
      <div class="fg"><label>ì—°ë½ì²˜</label><input type="text" id="fph" placeholder="010-0000-0000"></div>
      <div class="fg"><label>ì´ë©”ì¼</label><input type="email" id="fem" placeholder="email@example.com"></div>
      <div class="fg"><label>ì§€ì› ì§ë¬´ *</label><input type="text" id="fj" placeholder="í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì"></div>
      <div class="fg"><label>ì¶œì²˜</label>
        <select id="fsrc"><option>ì§ì ‘ì…ë ¥</option><option>ì‚¬ëŒì¸</option><option>ì¡ì½”ë¦¬ì•„</option><option>PDFì´ë ¥ì„œ</option></select>
      </div>
      <div class="fg"><label>ì±„ìš© ë‹¨ê³„</label>
        <select id="fst"><option>ì„œë¥˜ê²€í† </option><option>1ì°¨ë©´ì ‘</option><option>2ì°¨ë©´ì ‘</option><option>ìµœì¢…í•©ê²©</option><option>ë¶ˆí•©ê²©</option><option>ë³´ë¥˜</option></select>
      </div>
    </div>
    <div class="fg"><label>ê²½ë ¥ / í•™ë ¥ / AI ìš”ì•½</label><textarea id="fca" rows="5" placeholder="ì£¼ìš” ê²½ë ¥, í•™ë ¥, AI ë¶„ì„ ê²°ê³¼..."></textarea></div>
    <div class="fg"><label>ë©”ëª¨</label><textarea id="fmo" rows="3" placeholder="ë©´ì ‘ í”¼ë“œë°±, íŠ¹ì´ì‚¬í•­..."></textarea></div>
    <div class="mft"><button class="btn bg" onclick="closeModal('modal-add')">ì·¨ì†Œ</button><button class="btn bp" onclick="saveApplicant()">ì €ì¥</button></div>
  </div>
</div>

<!-- MODAL DETAIL -->
<div class="overlay" id="modal-det">
  <div class="modal mlg">
    <div class="mhd"><h2 id="det-name">ìƒì„¸</h2><button class="mclose" onclick="closeModal('modal-det')">Ã—</button></div>
    <div id="det-body"></div>
    <div class="mft">
      <button class="btn bd bsm" id="det-del">ğŸ—‘ï¸ ì‚­ì œ</button>
      <button class="btn bg" onclick="closeModal('modal-det')">ë‹«ê¸°</button>
      <button class="btn bp" id="det-edit">âœï¸ ìˆ˜ì •</button>
    </div>
  </div>
</div>

<div id="toast"></div>

<script>
/* â”€â”€ STATE â”€â”€ */
let DB  = JSON.parse(localStorage.getItem('rma3') || '[]');
let CFG = JSON.parse(localStorage.getItem('rma3c') || '{"ak":"","m":"gemini-1.5-flash"}');
let upData = null;
let detId  = null;
let stFilt = '';

/* â”€â”€ PERSIST â”€â”€ */
function save(){
  localStorage.setItem('rma3', JSON.stringify(DB));
  document.getElementById('nc').textContent = DB.length;
}

/* â”€â”€ NAVIGATION â”€â”€ */
document.querySelectorAll('.nav-item[data-pg]').forEach(el => {
  el.addEventListener('click', function(){ goPage(this.dataset.pg); });
});

const TITLES = { dashboard:'ëŒ€ì‹œë³´ë“œ', applicants:'ì§€ì›ì ëª©ë¡', upload:'ì´ë ¥ì„œ ì—…ë¡œë“œ', pipeline:'ì±„ìš© íŒŒì´í”„ë¼ì¸', settings:'ì„¤ì •' };

function goPage(pg){
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  const nav = document.querySelector('.nav-item[data-pg="'+pg+'"]');
  if(nav) nav.classList.add('active');
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  const pg_el = document.getElementById('page-'+pg);
  if(pg_el) pg_el.classList.add('active');
  document.getElementById('page-title').textContent = TITLES[pg] || pg;
  if(pg==='dashboard') renderDash();
  if(pg==='applicants'){ fillJobFilter(); renderList(); }
  if(pg==='pipeline') renderPipe();
}

/* â”€â”€ HELPERS â”€â”€ */
const uid = () => Date.now().toString(36)+Math.random().toString(36).slice(2,5);
const todayS = () => new Date().toLocaleDateString('ko-KR');
const fmtD = ts => new Date(ts).toLocaleDateString('ko-KR');

function badge(s){
  const e = {'ì„œë¥˜ê²€í† ':'ğŸ“‹','1ì°¨ë©´ì ‘':'ğŸ¤','2ì°¨ë©´ì ‘':'ğŸ¯','ìµœì¢…í•©ê²©':'âœ…','ë¶ˆí•©ê²©':'âŒ','ë³´ë¥˜':'â¸'}[s]||'';
  return `<span class="badge b-${s}">${e} ${s}</span>`;
}

/* â”€â”€ DASHBOARD â”€â”€ */
function renderDash(){
  const total = DB.length;
  const pass  = DB.filter(a=>a.stage==='ìµœì¢…í•©ê²©').length;
  const fail  = DB.filter(a=>a.stage==='ë¶ˆí•©ê²©').length;
  document.getElementById('s-total').textContent = total;
  document.getElementById('s-active').textContent = total - pass - fail;
  document.getElementById('s-pass').textContent  = pass;
  document.getElementById('s-fail').textContent  = fail;
  document.getElementById('s-rate').textContent  = total ? Math.round(pass/total*100) : 0;

  const stages = ['ì„œë¥˜ê²€í† ','1ì°¨ë©´ì ‘','2ì°¨ë©´ì ‘','ìµœì¢…í•©ê²©','ë¶ˆí•©ê²©'];
  stages.forEach((s,i) => {
    const el = document.getElementById('ps'+i);
    if(el) el.textContent = DB.filter(a=>a.stage===s).length;
  });

  const recent = [...DB].sort((a,b)=>b.ts-a.ts).slice(0,6);
  const tb = document.getElementById('dash-tb');
  tb.innerHTML = recent.length ? recent.map(a=>`
    <tr onclick="openDetail('${a.id}')">
      <td><strong>${a.name}</strong></td>
      <td>${a.job||'-'}</td><td>${a.source||'-'}</td>
      <td>${badge(a.stage)}</td>
      <td class="tm tsm">${fmtD(a.ts)}</td>
    </tr>`).join('') :
    `<tr><td colspan="5"><div class="empty"><div class="empty-i">ğŸ“­</div><div class="empty-t">ë“±ë¡ëœ ì§€ì›ìê°€ ì—†ìŠµë‹ˆë‹¤</div></div></td></tr>`;
  document.getElementById('nc').textContent = DB.length;
}

/* â”€â”€ LIST â”€â”€ */
function fillJobFilter(){
  const jobs = [...new Set(DB.map(a=>a.job).filter(Boolean))];
  const sel = document.getElementById('qjob');
  sel.innerHTML = '<option value="">ì „ì²´ ì§ë¬´</option>' + jobs.map(j=>`<option>${j}</option>`).join('');
}

function renderList(){
  const q   = document.getElementById('qs').value.toLowerCase();
  const src = document.getElementById('qsrc').value;
  const job = document.getElementById('qjob').value;

  let list = [...DB];
  if(q)   list = list.filter(a=>a.name.toLowerCase().includes(q)||(a.job||'').toLowerCase().includes(q)||(a.memo||'').toLowerCase().includes(q)||(a.career||'').toLowerCase().includes(q));
  if(src) list = list.filter(a=>a.source===src);
  if(job) list = list.filter(a=>a.job===job);
  if(stFilt) list = list.filter(a=>a.stage===stFilt);
  list.sort((a,b)=>b.ts-a.ts);

  document.getElementById('lcnt').textContent = list.length+'ëª…';
  const tb = document.getElementById('list-tb');
  tb.innerHTML = list.length ? list.map(a=>`
    <tr>
      <td><strong style="cursor:pointer;color:var(--blue)" onclick="openDetail('${a.id}')">${a.name}</strong></td>
      <td class="tm">${a.phone||'-'}</td>
      <td>${a.job||'-'}</td><td>${a.source||'-'}</td>
      <td>${badge(a.stage)}</td>
      <td class="tm tsm">${fmtD(a.ts)}</td>
      <td><div class="flex g2">
        <button class="btn bg bsm" onclick="openEdit('${a.id}')">ìˆ˜ì •</button>
        <button class="btn bd bsm" onclick="delApp('${a.id}')">ì‚­ì œ</button>
      </div></td>
    </tr>`).join('') :
    `<tr><td colspan="7"><div class="empty"><div class="empty-i">ğŸ”</div><div class="empty-t">ì¡°ê±´ì— ë§ëŠ” ì§€ì›ìê°€ ì—†ìŠµë‹ˆë‹¤</div></div></td></tr>`;
}

document.getElementById('qs').addEventListener('input', renderList);
document.getElementById('qsrc').addEventListener('change', renderList);
document.getElementById('qjob').addEventListener('change', renderList);

document.querySelectorAll('#chips .chip').forEach(c=>{
  c.addEventListener('click', function(){
    document.querySelectorAll('#chips .chip').forEach(x=>x.classList.remove('active'));
    this.classList.add('active');
    stFilt = this.dataset.st;
    renderList();
  });
});

/* â”€â”€ PIPELINE â”€â”€ */
function renderPipe(){
  const STAGES = [
    {k:'ì„œë¥˜ê²€í† ',c:'var(--blue)',e:'ğŸ“‹'},
    {k:'1ì°¨ë©´ì ‘',c:'var(--violet)',e:'ğŸ¤'},
    {k:'2ì°¨ë©´ì ‘',c:'var(--yellow)',e:'ğŸ¯'},
    {k:'ìµœì¢…í•©ê²©',c:'var(--green)',e:'âœ…'},
    {k:'ë¶ˆí•©ê²©',c:'var(--red)',e:'âŒ'},
  ];
  document.getElementById('board').innerHTML = STAGES.map(s=>{
    const cards = DB.filter(a=>a.stage===s.k);
    return `<div class="bcol">
      <div class="bcol-h" style="color:${s.c}">${s.e} ${s.k}<span class="bcol-cnt">${cards.length}</span></div>
      <div class="bcol-b">${cards.length ? cards.map(a=>`
        <div class="bcard" onclick="openDetail('${a.id}')">
          <div class="bcard-n">${a.name}</div>
          <div class="bcard-j">${a.job||'-'}</div>
          <div class="bcard-s">${a.source||''}</div>
        </div>`).join('') : '<div class="tm tsm" style="text-align:center;padding:16px">ì—†ìŒ</div>'}
      </div>
    </div>`;
  }).join('');
}

/* â”€â”€ ADD / EDIT â”€â”€ */
function openAddModal(){
  document.getElementById('add-ttl').textContent = 'ì§€ì›ì ì¶”ê°€';
  document.getElementById('eid').value = '';
  ['fn','fph','fem','fj','fca','fmo'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('fsrc').value = 'ì§ì ‘ì…ë ¥';
  document.getElementById('fst').value  = 'ì„œë¥˜ê²€í† ';
  openModal('modal-add');
}

function openEdit(id){
  const a = DB.find(x=>x.id===id);
  if(!a) return;
  closeModal('modal-det');
  document.getElementById('add-ttl').textContent = 'ì§€ì›ì ìˆ˜ì •';
  document.getElementById('eid').value = id;
  document.getElementById('fn').value  = a.name||'';
  document.getElementById('fph').value = a.phone||'';
  document.getElementById('fem').value = a.email||'';
  document.getElementById('fj').value  = a.job||'';
  document.getElementById('fsrc').value = a.source||'ì§ì ‘ì…ë ¥';
  document.getElementById('fst').value  = a.stage||'ì„œë¥˜ê²€í† ';
  document.getElementById('fca').value  = a.career||'';
  document.getElementById('fmo').value  = a.memo||'';
  openModal('modal-add');
}

function saveApplicant(){
  const name = document.getElementById('fn').value.trim();
  if(!name){ toast('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”','err'); return; }
  const id  = document.getElementById('eid').value;
  const nst = document.getElementById('fst').value;
  const d = {
    name, job:document.getElementById('fj').value.trim(),
    phone:document.getElementById('fph').value.trim(),
    email:document.getElementById('fem').value.trim(),
    source:document.getElementById('fsrc').value,
    stage:nst,
    career:document.getElementById('fca').value.trim(),
    memo:document.getElementById('fmo').value.trim(),
  };
  if(id){
    const idx = DB.findIndex(a=>a.id===id);
    const old = DB[idx];
    const hist = old.history||[];
    if(old.stage!==nst) hist.push({date:todayS(),msg:`ë‹¨ê³„ ë³€ê²½: ${old.stage} â†’ ${nst}`});
    hist.push({date:todayS(),msg:'ì •ë³´ ìˆ˜ì •'});
    d.id=id; d.ts=old.ts; d.history=hist;
    DB[idx]=d; toast('ìˆ˜ì • ì™„ë£Œ!','ok');
  } else {
    d.id=uid(); d.ts=Date.now();
    d.history=[{date:todayS(),msg:'ì§€ì›ì ë“±ë¡'}];
    DB.push(d); toast('ì €ì¥ ì™„ë£Œ!','ok');
  }
  save(); closeModal('modal-add');
  renderDash();
  if(document.getElementById('page-applicants').classList.contains('active')) renderList();
}

/* â”€â”€ DETAIL â”€â”€ */
function openDetail(id){
  const a = DB.find(x=>x.id===id);
  if(!a) return;
  detId = id;
  document.getElementById('det-name').textContent = a.name;
  document.getElementById('det-body').innerHTML = `
    <div class="dsec">
      <div class="dsec-t">ê¸°ë³¸ ì •ë³´</div>
      <div class="dgrd">
        <div><div class="di-l">ì§€ì› ì§ë¬´</div><div class="di-v">${a.job||'-'}</div></div>
        <div><div class="di-l">ì±„ìš© ë‹¨ê³„</div><div class="di-v">${badge(a.stage)}</div></div>
        <div><div class="di-l">ì—°ë½ì²˜</div><div class="di-v">${a.phone||'-'}</div></div>
        <div><div class="di-l">ì´ë©”ì¼</div><div class="di-v">${a.email||'-'}</div></div>
        <div><div class="di-l">ì¶œì²˜</div><div class="di-v">${a.source||'-'}</div></div>
        <div><div class="di-l">ë“±ë¡ì¼</div><div class="di-v">${fmtD(a.ts)}</div></div>
      </div>
      <div class="scbar mt3">
        <span class="tm tsm">ë‹¨ê³„ ë³€ê²½:</span>
        <select id="dstsel"><option>ì„œë¥˜ê²€í† </option><option>1ì°¨ë©´ì ‘</option><option>2ì°¨ë©´ì ‘</option><option>ìµœì¢…í•©ê²©</option><option>ë¶ˆí•©ê²©</option><option>ë³´ë¥˜</option></select>
        <button class="btn bg bsm" onclick="changeSt()">ë³€ê²½</button>
      </div>
    </div>
    ${a.career?`<div class="dsec"><div class="dsec-t">ê²½ë ¥ / AI ìš”ì•½</div><div class="dtxt">${a.career}</div></div>`:''}
    ${a.memo?`<div class="dsec"><div class="dsec-t">ë©”ëª¨</div><div class="dtxt">${a.memo}</div></div>`:''}
    <div class="dsec">
      <div class="dsec-t">ì§„í–‰ íˆìŠ¤í† ë¦¬</div>
      <div class="hist">${(a.history||[]).slice().reverse().map(h=>`
        <div class="hi"><div class="hidot"></div><div class="hidate">${h.date}</div><div>${h.msg}</div></div>`).join('')||'<div class="tm tsm">ê¸°ë¡ ì—†ìŒ</div>'}
      </div>
    </div>`;
  setTimeout(()=>{ const s=document.getElementById('dstsel'); if(s) s.value=a.stage; },10);
  document.getElementById('det-edit').onclick = ()=>openEdit(id);
  document.getElementById('det-del').onclick  = ()=>delApp(id);
  openModal('modal-det');
}

function changeSt(){
  const sel = document.getElementById('dstsel');
  if(!sel||!detId) return;
  const ns = sel.value;
  const idx = DB.findIndex(a=>a.id===detId);
  if(idx<0) return;
  const old = DB[idx];
  if(old.stage===ns){ toast('ì´ë¯¸ ê°™ì€ ë‹¨ê³„ì…ë‹ˆë‹¤',''); return; }
  old.history = old.history||[];
  old.history.push({date:todayS(),msg:`ë‹¨ê³„ ë³€ê²½: ${old.stage} â†’ ${ns}`});
  old.stage = ns;
  save(); closeModal('modal-det'); openDetail(detId); renderDash();
  toast(ns+'(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤','ok');
}

function delApp(id){
  if(!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  DB = DB.filter(a=>a.id!==id);
  save(); closeModal('modal-det'); renderDash();
  if(document.getElementById('page-applicants').classList.contains('active')) renderList();
  toast('ì‚­ì œ ì™„ë£Œ','ok');
}

/* â”€â”€ UPLOAD â”€â”€ */
const upz = document.getElementById('upz');
const fi  = document.getElementById('fi');
upz.addEventListener('click', ()=>fi.click());
fi.addEventListener('change', e=>{ if(e.target.files[0]) handleFile(e.target.files[0]); });
upz.addEventListener('dragover', e=>{ e.preventDefault(); upz.classList.add('drag'); });
upz.addEventListener('dragleave', ()=>upz.classList.remove('drag'));
upz.addEventListener('drop', e=>{ e.preventDefault(); upz.classList.remove('drag'); if(e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]); });

async function handleFile(file){
  toast('íŒŒì¼ ì½ëŠ” ì¤‘...','');
  document.getElementById('upfn').textContent = file.name;
  let text = file.name.endsWith('.pdf') ? await extractPDF(file) : await file.text();
  const parsed = parseResume(text, file.name);
  upData = {...parsed, raw: text.slice(0,4000)};
  document.getElementById('pgrd').innerHTML = `
    <div><div class="pf-l">ì´ë¦„ (ì¶”ì •)</div><div class="pf-v">${parsed.name||'ë¯¸ê°ì§€'}</div></div>
    <div><div class="pf-l">ì—°ë½ì²˜ (ì¶”ì •)</div><div class="pf-v">${parsed.phone||'ë¯¸ê°ì§€'}</div></div>
    <div><div class="pf-l">ì´ë©”ì¼ (ì¶”ì •)</div><div class="pf-v">${parsed.email||'ë¯¸ê°ì§€'}</div></div>
    <div><div class="pf-l">ì¶œì²˜ ê°ì§€</div><div class="pf-v">${parsed.source}</div></div>
    <div class="pfull"><div class="pf-l">í…ìŠ¤íŠ¸ ë¯¸ë¦¬ë³´ê¸°</div>
      <div style="margin-top:6px;font-size:11px;color:var(--muted);background:var(--s2);padding:10px;border-radius:7px;max-height:90px;overflow:auto;white-space:pre-wrap">${text.slice(0,400)}</div>
    </div>`;
  document.getElementById('airesbox').style.display='none';
  document.getElementById('upres').style.display='block';
  toast('íŒŒì¼ íŒŒì‹± ì™„ë£Œ!','ok');
}

async function extractPDF(file){
  return new Promise(res=>{
    const r = new FileReader();
    r.onload = e=>{
      const b = new Uint8Array(e.target.result);
      let s='';
      for(let i=0;i<b.length;i++){
        const c=b[i];
        if(c>=32&&c<127) s+=String.fromCharCode(c);
        else if(c===10||c===13) s+='\n';
      }
      res(s.split('\n').map(l=>l.trim()).filter(l=>l.length>1).join('\n'));
    };
    r.readAsArrayBuffer(file);
  });
}

function parseResume(text, fname){
  const low = (text+fname).toLowerCase();
  const src = low.includes('saramin')||low.includes('ì‚¬ëŒì¸')?'ì‚¬ëŒì¸':low.includes('jobkorea')||low.includes('ì¡ì½”ë¦¬ì•„')?'ì¡ì½”ë¦¬ì•„':fname.endsWith('.pdf')?'PDFì´ë ¥ì„œ':'ì§ì ‘ì…ë ¥';
  return {
    name: (text.match(/(?:ì´ë¦„|ì„±ëª…)\s*[:ï¼š]?\s*([ê°€-í£]{2,5})/)||[])[1]||'',
    phone:(text.match(/0\d{1,2}[-.\s]?\d{3,4}[-.\s]?\d{4}/)||[])[0]||'',
    email:(text.match(/[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}/)||[])[0]||'',
    source: src,
  };
}

async function runAI(){
  if(!CFG.ak){ toast('ì„¤ì •ì—ì„œ Gemini API Keyë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”','err'); return; }
  if(!upData) return;
  const btn = document.getElementById('aibtn');
  btn.innerHTML='<span class="spin"></span> ë¶„ì„ ì¤‘...'; btn.disabled=true;
  document.getElementById('airesbox').style.display='block';
  document.getElementById('aitext').textContent='AIê°€ ì´ë ¥ì„œë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...';

  const prompt=`ë‹¹ì‹ ì€ HR ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì•„ë˜ ì´ë ¥ì„œ í…ìŠ¤íŠ¸ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ í•­ëª©ì„ í•œêµ­ì–´ë¡œ êµ¬ì¡°ì ìœ¼ë¡œ ì •ë¦¬í•´ì£¼ì„¸ìš”.

[ë¶„ì„ í•­ëª©]
1. ì´ë¦„ / ì—°ë½ì²˜ / ì´ë©”ì¼ (í…ìŠ¤íŠ¸ì—ì„œ ì°¾ì•„ì„œ ê¸°ì¬)
2. í•™ë ¥ ìš”ì•½
3. ì£¼ìš” ê²½ë ¥ ìš”ì•½ (íšŒì‚¬ëª…, ì§ì±…, ê¸°ê°„ í¬í•¨)
4. í•µì‹¬ ê¸°ìˆ  ë° ì—­ëŸ‰
5. ì§€ì›ì ê°•ì  3ê°€ì§€
6. ì•„ì‰¬ìš´ ì  ë˜ëŠ” í™•ì¸ í•„ìš” ì‚¬í•­
7. ì„œë¥˜ í†µê³¼ ì¶”ì²œ ì—¬ë¶€ ë° í•œì¤„ ì½”ë©˜íŠ¸

[ì´ë ¥ì„œ ì›ë¬¸]
${upData.raw}`;

  try{
    const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${CFG.m}:generateContent?key=${CFG.ak}`,{
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({contents:[{parts:[{text:prompt}]}]})
    });
    const data = await resp.json();
    if(data.error) throw new Error(data.error.message);
    const result = data?.candidates?.[0]?.content?.parts?.[0]?.text||'ì‘ë‹µ ì—†ìŒ';
    document.getElementById('aitext').textContent = result;
    upData.aiSum = result;
    toast('AI ë¶„ì„ ì™„ë£Œ!','ok');
  } catch(e){
    document.getElementById('aitext').textContent = 'ì˜¤ë¥˜: '+e.message;
    toast('AI ì˜¤ë¥˜: '+e.message,'err');
  }
  btn.innerHTML='ğŸ¤– AI ë¶„ì„ Â· ìš”ì•½'; btn.disabled=false;
}

function saveFromUpload(){
  if(!upData) return;
  DB.push({
    id:uid(), ts:Date.now(),
    name:upData.name||'ì´ë¦„ ë¯¸ìƒ',
    phone:upData.phone||'', email:upData.email||'',
    source:upData.source, stage:'ì„œë¥˜ê²€í† ',
    career:upData.aiSum||upData.raw?.slice(0,800)||'',
    memo:'',
    history:[{date:todayS(),msg:`ì´ë ¥ì„œ ì—…ë¡œë“œ ë“±ë¡ (${upData.source})`}],
  });
  save(); resetUpload(); renderDash();
  toast('ì§€ì›ìë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!','ok');
  goPage('applicants');
}

function resetUpload(){
  upData=null;
  document.getElementById('upres').style.display='none';
  document.getElementById('airesbox').style.display='none';
  fi.value='';
}

/* â”€â”€ SETTINGS â”€â”€ */
document.getElementById('cak').value  = CFG.ak||'';
document.getElementById('cmod').value = CFG.m||'gemini-1.5-flash';

function saveCfg(){
  CFG.ak = document.getElementById('cak').value.trim();
  CFG.m  = document.getElementById('cmod').value;
  localStorage.setItem('rma3c', JSON.stringify(CFG));
  toast('ì„¤ì • ì €ì¥ ì™„ë£Œ!','ok');
}

function exportJSON(){
  const blob = new Blob([JSON.stringify({v:3,applicants:DB},null,2)],{type:'application/json'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='recruit_'+new Date().toISOString().slice(0,10)+'.json';
  a.click();
}

function importJSON(e){
  const file=e.target.files[0]; if(!file) return;
  const r=new FileReader();
  r.onload=ev=>{
    try{
      const d=JSON.parse(ev.target.result);
      if(d.applicants){ DB=d.applicants; save(); renderDash(); toast('ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ!','ok'); }
      else toast('ì˜¬ë°”ë¥¸ ë°±ì—… íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤','err');
    } catch{ toast('íŒŒì¼ íŒŒì‹± ì˜¤ë¥˜','err'); }
  };
  r.readAsText(file);
}

function clearAll(){
  if(!confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•©ë‹ˆê¹Œ? ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
  DB=[]; save(); renderDash(); toast('ì´ˆê¸°í™” ì™„ë£Œ','ok');
}

/* â”€â”€ MODAL â”€â”€ */
function openModal(id){ document.getElementById(id).classList.add('open'); }
function closeModal(id){ document.getElementById(id).classList.remove('open'); }
document.querySelectorAll('.overlay').forEach(el=>{
  el.addEventListener('click', e=>{ if(e.target===el) el.classList.remove('open'); });
});

/* â”€â”€ TOAST â”€â”€ */
function toast(msg, type){
  const el=document.getElementById('toast');
  el.textContent=msg;
  el.className='toast show'+(type?' '+type:'');
  clearTimeout(el._t);
  el._t=setTimeout(()=>{ el.className='toast'; },2600);
}

/* â”€â”€ INIT â”€â”€ */
renderDash();
document.getElementById('nc').textContent = DB.length;
</script>
</body>
</html>
